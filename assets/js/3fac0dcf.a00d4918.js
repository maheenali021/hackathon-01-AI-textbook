"use strict";(globalThis.webpackChunkphysical_ai_humanoid_robotics_book=globalThis.webpackChunkphysical_ai_humanoid_robotics_book||[]).push([[687],{5241:(e,s,i)=>{i.r(s),i.d(s,{assets:()=>c,contentTitle:()=>a,default:()=>u,frontMatter:()=>t,metadata:()=>n,toc:()=>o});const n=JSON.parse('{"id":"module1/publishers-subscribers","title":"Chapter 4: Publishers and Subscribers in ROS 2","description":"Understanding Publish-Subscribe Pattern","source":"@site/docs/module1/publishers-subscribers.md","sourceDirName":"module1","slug":"/module1/publishers-subscribers","permalink":"/hackathon-01-AI-textbook/docs/module1/publishers-subscribers","draft":false,"unlisted":false,"editUrl":"https://github.com/maheenali021/hackathon-01-AI-textbook/tree/main/docs/module1/publishers-subscribers.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"title":"Chapter 4: Publishers and Subscribers in ROS 2"},"sidebar":"tutorialSidebar","previous":{"title":"Chapter 3: ROS 2 Architecture Basics","permalink":"/hackathon-01-AI-textbook/docs/module1/ros2-architecture-basics"},"next":{"title":"Chapter 5: Services and Actions for Robot Control","permalink":"/hackathon-01-AI-textbook/docs/module1/services-actions-control"}}');var r=i(4848),l=i(8453);const t={sidebar_position:4,title:"Chapter 4: Publishers and Subscribers in ROS 2"},a="Publishers and Subscribers in ROS 2",c={},o=[{value:"Understanding Publish-Subscribe Pattern",id:"understanding-publish-subscribe-pattern",level:2},{value:"Creating Publishers",id:"creating-publishers",level:2},{value:"Basic Publisher Structure",id:"basic-publisher-structure",level:3},{value:"Advanced Publisher Features",id:"advanced-publisher-features",level:3},{value:"Creating Subscribers",id:"creating-subscribers",level:2},{value:"Basic Subscriber Structure",id:"basic-subscriber-structure",level:3},{value:"Message Types and Serialization",id:"message-types-and-serialization",level:2},{value:"Built-in Message Types",id:"built-in-message-types",level:3},{value:"Custom Message Types",id:"custom-message-types",level:3},{value:"Advanced Patterns",id:"advanced-patterns",level:2},{value:"Multiple Publishers and Subscribers",id:"multiple-publishers-and-subscribers",level:3},{value:"Conditional Publishing",id:"conditional-publishing",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Error Handling",id:"error-handling",level:3},{value:"Memory Management",id:"memory-management",level:3},{value:"Thread Safety",id:"thread-safety",level:3},{value:"Quality of Service Considerations",id:"quality-of-service-considerations",level:2},{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"Hands-on Exercise",id:"hands-on-exercise",level:2}];function d(e){const s={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"publishers-and-subscribers-in-ros-2",children:"Publishers and Subscribers in ROS 2"})}),"\n",(0,r.jsx)(s.h2,{id:"understanding-publish-subscribe-pattern",children:"Understanding Publish-Subscribe Pattern"}),"\n",(0,r.jsx)(s.p,{children:"The publish-subscribe pattern is the fundamental communication mechanism in ROS 2. Publishers send messages to topics, and subscribers receive messages from topics."}),"\n",(0,r.jsx)(s.h2,{id:"creating-publishers",children:"Creating Publishers"}),"\n",(0,r.jsx)(s.h3,{id:"basic-publisher-structure",children:"Basic Publisher Structure"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nclass MinimalPublisher(Node):\n    def __init__(self):\n        super().__init__('minimal_publisher')\n        self.publisher_ = self.create_publisher(String, 'topic', 10)\n        timer_period = 0.5  # seconds\n        self.timer = self.create_timer(timer_period, self.timer_callback)\n        self.i = 0\n\n    def timer_callback(self):\n        msg = String()\n        msg.data = f'Hello World: {self.i}'\n        self.publisher_.publish(msg)\n        self.get_logger().info(f'Publishing: \"{msg.data}\"')\n        self.i += 1\n\ndef main(args=None):\n    rclpy.init(args=args)\n    minimal_publisher = MinimalPublisher()\n    rclpy.spin(minimal_publisher)\n    minimal_publisher.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsx)(s.h3,{id:"advanced-publisher-features",children:"Advanced Publisher Features"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"from rclpy.qos import QoSProfile, HistoryPolicy, ReliabilityPolicy\n\n# Create a publisher with custom QoS settings\nqos_profile = QoSProfile(\n    depth=10,\n    history=HistoryPolicy.KEEP_LAST,\n    reliability=ReliabilityPolicy.RELIABLE\n)\n\npublisher = self.create_publisher(String, 'topic', qos_profile)\n"})}),"\n",(0,r.jsx)(s.h2,{id:"creating-subscribers",children:"Creating Subscribers"}),"\n",(0,r.jsx)(s.h3,{id:"basic-subscriber-structure",children:"Basic Subscriber Structure"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nclass MinimalSubscriber(Node):\n    def __init__(self):\n        super().__init__('minimal_subscriber')\n        self.subscription = self.create_subscription(\n            String,\n            'topic',\n            self.listener_callback,\n            10)\n        self.subscription  # prevent unused variable warning\n\n    def listener_callback(self, msg):\n        self.get_logger().info(f'I heard: \"{msg.data}\"')\n\ndef main(args=None):\n    rclpy.init(args=args)\n    minimal_subscriber = MinimalSubscriber()\n    rclpy.spin(minimal_subscriber)\n    minimal_subscriber.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsx)(s.h2,{id:"message-types-and-serialization",children:"Message Types and Serialization"}),"\n",(0,r.jsx)(s.h3,{id:"built-in-message-types",children:"Built-in Message Types"}),"\n",(0,r.jsx)(s.p,{children:"ROS 2 provides various built-in message types:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"std_msgs"}),": Basic data types (String, Int32, Float64, etc.)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"geometry_msgs"}),": Geometric primitives (Point, Pose, Twist, etc.)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"sensor_msgs"}),": Sensor data (LaserScan, Image, JointState, etc.)"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"custom-message-types",children:"Custom Message Types"}),"\n",(0,r.jsxs)(s.p,{children:["Create custom messages by defining ",(0,r.jsx)(s.code,{children:".msg"})," files in the ",(0,r.jsx)(s.code,{children:"msg/"})," directory:"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-txt",children:"# CustomMessage.msg\nstring name\nint32 id\nfloat64[] values\ngeometry_msgs/Pose pose\n"})}),"\n",(0,r.jsx)(s.h2,{id:"advanced-patterns",children:"Advanced Patterns"}),"\n",(0,r.jsx)(s.h3,{id:"multiple-publishers-and-subscribers",children:"Multiple Publishers and Subscribers"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"class MultiTopicNode(Node):\n    def __init__(self):\n        super().__init__('multi_topic_node')\n\n        # Multiple publishers\n        self.pub1 = self.create_publisher(String, 'topic1', 10)\n        self.pub2 = self.create_publisher(Int32, 'topic2', 10)\n\n        # Multiple subscribers\n        self.sub1 = self.create_subscription(String, 'topic1', self.callback1, 10)\n        self.sub2 = self.create_subscription(Int32, 'topic2', self.callback2, 10)\n"})}),"\n",(0,r.jsx)(s.h3,{id:"conditional-publishing",children:"Conditional Publishing"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"def conditional_publish(self, data):\n    if self.should_publish:\n        self.publisher.publish(data)\n"})}),"\n",(0,r.jsx)(s.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,r.jsx)(s.h3,{id:"error-handling",children:"Error Handling"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"try:\n    self.publisher.publish(msg)\nexcept Exception as e:\n    self.get_logger().error(f'Failed to publish message: {e}')\n"})}),"\n",(0,r.jsx)(s.h3,{id:"memory-management",children:"Memory Management"}),"\n",(0,r.jsx)(s.admonition,{type:"tip",children:(0,r.jsxs)(s.p,{children:["Use ",(0,r.jsx)(s.code,{children:"rclpy.qos.QoSHistoryPolicy.KEEP_LAST"})," with appropriate depth to manage memory usage when publishing high-frequency messages."]})}),"\n",(0,r.jsx)(s.h3,{id:"thread-safety",children:"Thread Safety"}),"\n",(0,r.jsx)(s.p,{children:"Subscribers run in the same thread as the executor, so avoid long-running operations in callbacks."}),"\n",(0,r.jsx)(s.h2,{id:"quality-of-service-considerations",children:"Quality of Service Considerations"}),"\n",(0,r.jsx)(s.p,{children:"Different QoS settings affect performance and reliability:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Reliable vs Best Effort"}),": Choose based on whether message loss is acceptable"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Keep Last vs Keep All"}),": Consider memory usage for high-frequency topics"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Deadline and Lifespan"}),": Configure for time-sensitive applications"]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,r.jsx)(s.p,{children:"After completing this chapter, you will be able to:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Create publishers and subscribers in ROS 2"}),"\n",(0,r.jsx)(s.li,{children:"Configure Quality of Service settings appropriately"}),"\n",(0,r.jsx)(s.li,{children:"Handle different message types"}),"\n",(0,r.jsx)(s.li,{children:"Implement advanced publish-subscribe patterns"}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"hands-on-exercise",children:"Hands-on Exercise"}),"\n",(0,r.jsx)(s.p,{children:"Create a publisher that sends sensor data and a subscriber that processes and visualizes the data. Experiment with different QoS settings to observe their effects."}),"\n",(0,r.jsx)(s.admonition,{type:"warning",children:(0,r.jsxs)(s.p,{children:["Remember to always call ",(0,r.jsx)(s.code,{children:"rclpy.shutdown()"})," when your node exits to properly clean up resources."]})})]})}function u(e={}){const{wrapper:s}={...(0,l.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,s,i)=>{i.d(s,{R:()=>t,x:()=>a});var n=i(6540);const r={},l=n.createContext(r);function t(e){const s=n.useContext(l);return n.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),n.createElement(l.Provider,{value:s},e.children)}}}]);